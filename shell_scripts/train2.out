CUDA is a parallel computing platform for computing on GPUs, https://developer.nvidia.com/cuda-toolkit
prepending to __UENV: cuda-11.4.4
setting env CUDA_HOME=/usr/local/_cuda/cuda-11.4.4_ubuntu22
prepending to PATH: /usr/local/_cuda/cuda-11.4.4_ubuntu22/bin
prepending to LD_LIBRARY_PATH: /usr/local/_cuda/cuda-11.4.4_ubuntu22/lib64


A GPU-accelerated library of primitives for deep neural networks, https://developer.nvidia.com/cudnn
prepending to __UENV: cudnn-11.x-8.8.0
prepending to LD_LIBRARY_PATH: /usr/local/_cuda/cudnn-11.x-8.8.0/lib



Python 3.11.5
2025-04-02 12:40:28,678 [INFO] Using device: cuda
2025-04-02 12:40:28,680 [INFO] Using remote paths
2025-04-02 12:40:28,682 [INFO] Data root: /home/stud/aleks99/.cache/kagglehub/datasets/wildlifedatasets/wildlifereid-10k/versions/6
2025-04-02 12:40:28,684 [INFO] Save path: /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/bbefficientnet_b0_bz128_e4_lr0.001_m2_r160_n1000/
2025-04-02 12:40:28,735 [INFO] GPU: NVIDIA A100-PCIE-40GB
2025-04-02 12:40:28,737 [INFO] Loading dataset...
2025-04-02 12:40:33,878 [INFO] PyTorch version 2.6.0 available.
Loaded 781 images across 666 identities.
2025-04-02 12:40:40,570 [INFO] Dataset split: 625 training samples, 156 validation samples
2025-04-02 12:40:40,651 [INFO] Loading pretrained weights from Hugging Face hub (timm/efficientnet_b0.ra_in1k)
2025-04-02 12:40:42,525 [INFO] [timm/efficientnet_b0.ra_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
/mnt/beegfs/home/aleks99/DAT550-Animal-CLEF/shell_scripts/../model/arg_run.py:201: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
/home/stud/aleks99/.local/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
2025-04-02 12:40:45,120 [INFO] Started epoch 1
/mnt/beegfs/home/aleks99/DAT550-Animal-CLEF/shell_scripts/../model/arg_run.py:59: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/mnt/beegfs/home/aleks99/DAT550-Animal-CLEF/shell_scripts/../model/arg_run.py:80: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
2025-04-02 12:41:13,597 [INFO] [Epoch 1] Train Loss: 23.5633, Val Loss: 10.8768
2025-04-02 12:41:13,598 [INFO]  Epoch time: 28.48 sec
2025-04-02 12:41:13,749 [INFO]  Saved new best model at epoch 1
2025-04-02 12:41:13,751 [INFO] Started epoch 2
2025-04-02 12:41:43,612 [INFO] [Epoch 2] Train Loss: 6.8546, Val Loss: 10.1946
2025-04-02 12:41:43,614 [INFO]  Epoch time: 29.86 sec
2025-04-02 12:41:43,723 [INFO]  Saved new best model at epoch 2
2025-04-02 12:41:43,725 [INFO] Started epoch 3
2025-04-02 12:42:12,838 [INFO] [Epoch 3] Train Loss: 2.2109, Val Loss: 10.1923
2025-04-02 12:42:12,840 [INFO]  Epoch time: 29.12 sec
2025-04-02 12:42:12,947 [INFO]  Saved new best model at epoch 3
2025-04-02 12:42:12,948 [INFO] Started epoch 4
2025-04-02 12:42:43,599 [INFO] [Epoch 4] Train Loss: 0.5104, Val Loss: 10.9409
2025-04-02 12:42:43,602 [INFO]  Epoch time: 30.65 sec
/var/spool/slurmd/job403625/slurm_script: line 19: --batch_size: command not found
2025-04-02 12:58:17,421 [INFO] [Epoch 35] ArcFace Loss: 0.1001
2025-04-02 12:58:17,423 [INFO]  Epoch time: 1617.52 sec
2025-04-02 12:58:17,548 [INFO]  Saved new best model at epoch 35
2025-04-02 12:58:17,550 [INFO] Started epoch 36
2025-04-02 13:26:20,073 [INFO] [Epoch 36] ArcFace Loss: 0.0993
2025-04-02 13:26:20,076 [INFO]  Epoch time: 1682.53 sec
2025-04-02 13:26:20,239 [INFO]  Saved new best model at epoch 36
2025-04-02 13:26:20,241 [INFO] Started epoch 37
2025-04-02 13:54:18,559 [INFO] [Epoch 37] ArcFace Loss: 0.0896
2025-04-02 13:54:18,561 [INFO]  Epoch time: 1678.32 sec
2025-04-02 13:54:18,676 [INFO]  Saved new best model at epoch 37
2025-04-02 13:54:18,677 [INFO] Started epoch 38
2025-04-02 14:23:58,441 [INFO] [Epoch 38] ArcFace Loss: 0.0866
2025-04-02 14:23:58,443 [INFO]  Epoch time: 1779.77 sec
2025-04-02 14:23:58,563 [INFO]  Saved new best model at epoch 38
2025-04-02 14:23:58,565 [INFO] Started epoch 39
2025-04-02 14:51:14,467 [INFO] [Epoch 39] ArcFace Loss: 0.0864
2025-04-02 14:51:14,469 [INFO]  Epoch time: 1635.90 sec
2025-04-02 14:51:14,597 [INFO]  Saved new best model at epoch 39
2025-04-02 14:51:14,598 [INFO] Started epoch 40
2025-04-02 15:19:09,676 [INFO] [Epoch 40] ArcFace Loss: 0.0800
2025-04-02 15:19:09,677 [INFO]  Epoch time: 1675.08 sec
2025-04-02 15:19:09,816 [INFO]  Saved new best model at epoch 40
2025-04-02 15:19:09,818 [INFO] Started epoch 41
2025-04-02 15:45:50,558 [INFO] [Epoch 41] ArcFace Loss: 0.0708
2025-04-02 15:45:50,560 [INFO]  Epoch time: 1600.74 sec
2025-04-02 15:45:50,683 [INFO]  Saved new best model at epoch 41
2025-04-02 15:45:50,685 [INFO] Started epoch 42
2025-04-02 16:11:55,537 [INFO] [Epoch 42] ArcFace Loss: 0.0780
2025-04-02 16:11:55,538 [INFO]  Epoch time: 1564.85 sec
2025-04-02 16:11:55,539 [INFO] Started epoch 43
2025-04-02 16:37:58,015 [INFO] [Epoch 43] ArcFace Loss: 0.0710
2025-04-02 16:37:58,017 [INFO]  Epoch time: 1562.48 sec
2025-04-02 16:37:58,018 [INFO] Started epoch 44
2025-04-02 17:03:43,185 [INFO] [Epoch 44] ArcFace Loss: 0.0721
2025-04-02 17:03:43,186 [INFO]  Epoch time: 1545.17 sec
2025-04-02 17:03:43,188 [INFO] Started epoch 45
2025-04-02 17:29:35,546 [INFO] [Epoch 45] ArcFace Loss: 0.0470
2025-04-02 17:29:35,548 [INFO]  Epoch time: 1552.36 sec
2025-04-02 17:29:35,668 [INFO]  Saved new best model at epoch 45
2025-04-02 17:29:35,670 [INFO] Started epoch 46
2025-04-02 17:55:29,149 [INFO] [Epoch 46] ArcFace Loss: 0.0356
2025-04-02 17:55:29,152 [INFO]  Epoch time: 1553.48 sec
2025-04-02 17:55:29,287 [INFO]  Saved new best model at epoch 46
2025-04-02 17:55:29,290 [INFO] Started epoch 47
slurmstepd: error: *** JOB 403567 ON gorina8 CANCELLED AT 2025-04-02T18:03:34 DUE TO TIME LIMIT ***
