2025-04-21 09:29:06,476 [INFO] === TRAINING CONFIGURATION ===
2025-04-21 09:29:06,478 [INFO] Backbone: resnet18
2025-04-21 09:29:06,480 [INFO] Batch size: 16
2025-04-21 09:29:06,481 [INFO] Epochs: 15
2025-04-21 09:29:06,482 [INFO] Learning rate: 0.0001
2025-04-21 09:29:06,484 [INFO] Images per class (M): 4
2025-04-21 09:29:06,485 [INFO] Image size: 288x288
2025-04-21 09:29:06,487 [INFO] Dataset size (n): 140000
2025-04-21 09:29:06,488 [INFO] Validation split: 0.2
2025-04-21 09:29:06,490 [INFO] Weight decay: 5e-05
2025-04-21 09:29:06,491 [INFO] Dropout rate: 0.3
2025-04-21 09:29:06,492 [INFO] Scheduler: cosine
2025-04-21 09:29:06,494 [INFO] Early stopping patience: 10
2025-04-21 09:29:06,495 [INFO] Data augmentation: True
2025-04-21 09:29:06,496 [INFO] Embedding dimension: 512
2025-04-21 09:29:06,498 [INFO] Loss type: arcface
2025-04-21 09:29:06,499 [INFO] Margin: 0.3
2025-04-21 09:29:06,501 [INFO] Scale: 64.0
2025-04-21 09:29:06,502 [INFO] =============================
2025-04-21 09:29:06,623 [INFO] Using device: cuda
2025-04-21 09:29:06,624 [INFO] Using remote paths
2025-04-21 09:29:06,626 [INFO] Data root: /home/stud/aleks99/.cache/kagglehub/datasets/wildlifedatasets/wildlifereid-10k/versions/6
2025-04-21 09:29:06,627 [INFO] Save path: /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18batchsize32to16/
2025-04-21 09:29:06,701 [INFO] GPU: NVIDIA A100-PCIE-40GB
2025-04-21 09:29:06,703 [INFO] Using data augmentation
2025-04-21 09:29:06,705 [INFO] Loading dataset...
2025-04-21 09:29:07,447 [INFO] PyTorch version 2.6.0 available.
2025-04-21 09:29:14,237 [INFO] Dataset split: 89518 training samples, 22379 validation samples
2025-04-21 09:29:14,447 [INFO] Loading pretrained weights from Hugging Face hub (timm/resnet18.a1_in1k)
2025-04-21 09:29:14,830 [INFO] [timm/resnet18.a1_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-04-21 09:29:15,803 [INFO] Using ArcFace loss with margin=0.3, scale=64.0
2025-04-21 09:29:15,806 [INFO] Using CosineAnnealingLR scheduler
2025-04-21 09:29:15,808 [INFO] Started epoch 1
2025-04-21 10:22:07,040 [INFO] [Epoch 1] Train Loss: 11.9635, Val Loss: 11.5032, LR: 0.000100
2025-04-21 10:22:07,043 [INFO]  Epoch time: 3171.23 sec
2025-04-21 10:22:08,066 [INFO]  Saved new best model at epoch 1 to /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18batchsize32to16/trained_model_arcface.pth
2025-04-21 10:22:08,068 [INFO] Started epoch 2
2025-04-21 11:15:00,177 [INFO] [Epoch 2] Train Loss: 11.4949, Val Loss: 11.3054, LR: 0.000099
2025-04-21 11:15:00,179 [INFO]  Epoch time: 3172.11 sec
2025-04-21 11:15:01,038 [INFO]  Saved new best model at epoch 2 to /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18batchsize32to16/trained_model_arcface.pth
2025-04-21 11:15:01,040 [INFO] Started epoch 3
2025-04-21 12:07:31,292 [INFO] [Epoch 3] Train Loss: 11.3124, Val Loss: 11.0284, LR: 0.000096
2025-04-21 12:07:31,294 [INFO]  Epoch time: 3150.25 sec
2025-04-21 12:07:32,253 [INFO]  Saved new best model at epoch 3 to /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18batchsize32to16/trained_model_arcface.pth
2025-04-21 12:07:32,255 [INFO] Started epoch 4
2025-04-21 13:00:40,656 [INFO] [Epoch 4] Train Loss: 11.0758, Val Loss: 10.6740, LR: 0.000091
2025-04-21 13:00:40,658 [INFO]  Epoch time: 3188.40 sec
2025-04-21 13:00:41,514 [INFO]  Saved new best model at epoch 4 to /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18batchsize32to16/trained_model_arcface.pth
2025-04-21 13:00:41,516 [INFO] Started epoch 5
2025-04-21 13:52:58,283 [INFO] [Epoch 5] Train Loss: 10.7654, Val Loss: 10.2711, LR: 0.000084
2025-04-21 13:52:58,285 [INFO]  Epoch time: 3136.77 sec
2025-04-21 13:52:59,224 [INFO]  Saved new best model at epoch 5 to /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18batchsize32to16/trained_model_arcface.pth
2025-04-21 13:52:59,226 [INFO] Started epoch 6
2025-04-21 14:45:50,757 [INFO] [Epoch 6] Train Loss: 10.3690, Val Loss: 9.8238, LR: 0.000075
2025-04-21 14:45:50,759 [INFO]  Epoch time: 3171.53 sec
2025-04-21 14:45:51,535 [INFO]  Saved new best model at epoch 6 to /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18batchsize32to16/trained_model_arcface.pth
2025-04-21 14:45:51,537 [INFO] Started epoch 7
2025-04-21 15:38:41,982 [INFO] [Epoch 7] Train Loss: 9.9437, Val Loss: 9.4172, LR: 0.000066
2025-04-21 15:38:41,984 [INFO]  Epoch time: 3170.45 sec
2025-04-21 15:38:42,755 [INFO]  Saved new best model at epoch 7 to /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18batchsize32to16/trained_model_arcface.pth
2025-04-21 15:38:42,756 [INFO] Started epoch 8
2025-04-21 16:32:02,744 [INFO] [Epoch 8] Train Loss: 9.5110, Val Loss: 9.1025, LR: 0.000056
2025-04-21 16:32:02,745 [INFO]  Epoch time: 3199.99 sec
2025-04-21 16:32:03,558 [INFO]  Saved new best model at epoch 8 to /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18batchsize32to16/trained_model_arcface.pth
2025-04-21 16:32:03,560 [INFO] Started epoch 9
2025-04-21 17:24:41,394 [INFO] [Epoch 9] Train Loss: 9.1408, Val Loss: 8.8846, LR: 0.000045
2025-04-21 17:24:41,396 [INFO]  Epoch time: 3157.84 sec
2025-04-21 17:24:42,184 [INFO]  Saved new best model at epoch 9 to /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18batchsize32to16/trained_model_arcface.pth
2025-04-21 17:24:42,186 [INFO] Started epoch 10
2025-04-21 18:17:45,508 [INFO] [Epoch 10] Train Loss: 8.8329, Val Loss: 8.7325, LR: 0.000035
2025-04-21 18:17:45,509 [INFO]  Epoch time: 3183.32 sec
2025-04-21 18:17:46,251 [INFO]  Saved new best model at epoch 10 to /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18batchsize32to16/trained_model_arcface.pth
2025-04-21 18:17:46,253 [INFO] Started epoch 11
2025-04-21 19:10:41,555 [INFO] [Epoch 11] Train Loss: 8.6021, Val Loss: 8.6469, LR: 0.000026
2025-04-21 19:10:41,557 [INFO]  Epoch time: 3175.30 sec
2025-04-21 19:10:42,315 [INFO]  Saved new best model at epoch 11 to /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18batchsize32to16/trained_model_arcface.pth
2025-04-21 19:10:42,316 [INFO] Started epoch 12
2025-04-21 20:03:09,142 [INFO] [Epoch 12] Train Loss: 8.4127, Val Loss: 8.5905, LR: 0.000017
2025-04-21 20:03:09,144 [INFO]  Epoch time: 3146.83 sec
2025-04-21 20:03:09,904 [INFO]  Saved new best model at epoch 12 to /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18batchsize32to16/trained_model_arcface.pth
2025-04-21 20:03:09,906 [INFO] Started epoch 13
2025-04-21 20:55:42,796 [INFO] [Epoch 13] Train Loss: 8.2725, Val Loss: 8.5377, LR: 0.000010
2025-04-21 20:55:42,798 [INFO]  Epoch time: 3152.89 sec
2025-04-21 20:55:43,586 [INFO]  Saved new best model at epoch 13 to /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18batchsize32to16/trained_model_arcface.pth
2025-04-21 20:55:43,587 [INFO] Started epoch 14
2025-04-21 21:48:44,277 [INFO] [Epoch 14] Train Loss: 8.2144, Val Loss: 8.5347, LR: 0.000005
2025-04-21 21:48:44,279 [INFO]  Epoch time: 3180.69 sec
2025-04-21 21:48:45,564 [INFO]  Saved new best model at epoch 14 to /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18batchsize32to16/trained_model_arcface.pth
2025-04-21 21:48:45,566 [INFO] Started epoch 15
2025-04-21 22:42:39,783 [INFO] [Epoch 15] Train Loss: 8.1671, Val Loss: 8.4955, LR: 0.000002
2025-04-21 22:42:39,786 [INFO]  Epoch time: 3234.22 sec
2025-04-21 22:42:41,287 [INFO]  Saved new best model at epoch 15 to /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18batchsize32to16/trained_model_arcface.pth
2025-04-21 22:42:41,289 [INFO] Training completed. Starting evaluation...
2025-04-21 23:47:11,458 [ERROR] Evaluation failed: Command '['/opt/miniconda3-py311/bin/python', '/home/stud/aleks99/bhome/DAT550-Animal-CLEF/model/evaluate_open_set.py', '--model_path', '/home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18batchsize32to16/trained_model_arcface.pth', '--backbone', 'resnet18', '--embedding_dim', '512', '--batch_size', '16', '--resize', '288', '--output_dir', '/home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18batchsize32to16/open_set_evaluation', '--loss_type', 'arcface', '--remote']' returned non-zero exit status 1.
2025-04-21 23:47:11,459 [ERROR] Failed command: /opt/miniconda3-py311/bin/python /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model/evaluate_open_set.py --model_path /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18batchsize32to16/trained_model_arcface.pth --backbone resnet18 --embedding_dim 512 --batch_size 16 --resize 288 --output_dir /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18batchsize32to16/open_set_evaluation --loss_type arcface --remote
