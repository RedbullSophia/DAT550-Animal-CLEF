2025-04-21 09:29:09,524 [INFO] === TRAINING CONFIGURATION ===
2025-04-21 09:29:09,526 [INFO] Backbone: resnet18
2025-04-21 09:29:09,528 [INFO] Batch size: 32
2025-04-21 09:29:09,529 [INFO] Epochs: 15
2025-04-21 09:29:09,531 [INFO] Learning rate: 0.0001
2025-04-21 09:29:09,532 [INFO] Images per class (M): 4
2025-04-21 09:29:09,534 [INFO] Image size: 288x288
2025-04-21 09:29:09,535 [INFO] Dataset size (n): 140000
2025-04-21 09:29:09,537 [INFO] Validation split: 0.2
2025-04-21 09:29:09,538 [INFO] Weight decay: 5e-05
2025-04-21 09:29:09,539 [INFO] Dropout rate: 0.3
2025-04-21 09:29:09,541 [INFO] Scheduler: cosine
2025-04-21 09:29:09,542 [INFO] Early stopping patience: 10
2025-04-21 09:29:09,544 [INFO] Data augmentation: False
2025-04-21 09:29:09,546 [INFO] Embedding dimension: 512
2025-04-21 09:29:09,548 [INFO] Loss type: arcface
2025-04-21 09:29:09,549 [INFO] Margin: 0.3
2025-04-21 09:29:09,550 [INFO] Scale: 64.0
2025-04-21 09:29:09,552 [INFO] =============================
2025-04-21 09:29:09,669 [INFO] Using device: cuda
2025-04-21 09:29:09,671 [INFO] Using remote paths
2025-04-21 09:29:09,673 [INFO] Data root: /home/stud/aleks99/.cache/kagglehub/datasets/wildlifedatasets/wildlifereid-10k/versions/6
2025-04-21 09:29:09,674 [INFO] Save path: /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18noaugmentation/
2025-04-21 09:29:09,723 [INFO] GPU: NVIDIA A100-PCIE-40GB
2025-04-21 09:29:09,725 [INFO] Loading dataset...
2025-04-21 09:29:10,524 [INFO] PyTorch version 2.6.0 available.
2025-04-21 09:29:17,504 [INFO] Dataset split: 89518 training samples, 22379 validation samples
2025-04-21 09:29:17,716 [INFO] Loading pretrained weights from Hugging Face hub (timm/resnet18.a1_in1k)
2025-04-21 09:29:18,093 [INFO] [timm/resnet18.a1_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-04-21 09:29:18,993 [INFO] Using ArcFace loss with margin=0.3, scale=64.0
2025-04-21 09:29:18,996 [INFO] Using CosineAnnealingLR scheduler
2025-04-21 09:29:18,998 [INFO] Started epoch 1
2025-04-21 10:07:45,459 [INFO] [Epoch 1] Train Loss: 12.0438, Val Loss: 11.4121, LR: 0.000100
2025-04-21 10:07:45,461 [INFO]  Epoch time: 2306.46 sec
2025-04-21 10:07:46,589 [INFO]  Saved new best model at epoch 1 to /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18noaugmentation/trained_model_arcface.pth
2025-04-21 10:07:46,591 [INFO] Started epoch 2
2025-04-21 10:45:46,045 [INFO] [Epoch 2] Train Loss: 11.4286, Val Loss: 11.1428, LR: 0.000099
2025-04-21 10:45:46,047 [INFO]  Epoch time: 2279.46 sec
2025-04-21 10:45:46,838 [INFO]  Saved new best model at epoch 2 to /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18noaugmentation/trained_model_arcface.pth
2025-04-21 10:45:46,839 [INFO] Started epoch 3
2025-04-21 11:23:32,010 [INFO] [Epoch 3] Train Loss: 11.1566, Val Loss: 10.8631, LR: 0.000096
2025-04-21 11:23:32,012 [INFO]  Epoch time: 2265.17 sec
2025-04-21 11:23:32,909 [INFO]  Saved new best model at epoch 3 to /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18noaugmentation/trained_model_arcface.pth
2025-04-21 11:23:32,911 [INFO] Started epoch 4
2025-04-21 12:00:35,333 [INFO] [Epoch 4] Train Loss: 10.7877, Val Loss: 10.4964, LR: 0.000091
2025-04-21 12:00:35,335 [INFO]  Epoch time: 2222.42 sec
2025-04-21 12:00:36,179 [INFO]  Saved new best model at epoch 4 to /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18noaugmentation/trained_model_arcface.pth
2025-04-21 12:00:36,180 [INFO] Started epoch 5
2025-04-21 12:38:48,044 [INFO] [Epoch 5] Train Loss: 10.1517, Val Loss: 10.0100, LR: 0.000084
2025-04-21 12:38:48,045 [INFO]  Epoch time: 2291.87 sec
2025-04-21 12:38:49,033 [INFO]  Saved new best model at epoch 5 to /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18noaugmentation/trained_model_arcface.pth
2025-04-21 12:38:49,034 [INFO] Started epoch 6
2025-04-21 13:16:49,813 [INFO] [Epoch 6] Train Loss: 9.3129, Val Loss: 9.7203, LR: 0.000075
2025-04-21 13:16:49,815 [INFO]  Epoch time: 2280.78 sec
2025-04-21 13:16:50,562 [INFO]  Saved new best model at epoch 6 to /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18noaugmentation/trained_model_arcface.pth
2025-04-21 13:16:50,564 [INFO] Started epoch 7
2025-04-21 13:54:24,722 [INFO] [Epoch 7] Train Loss: 8.5883, Val Loss: 9.4841, LR: 0.000066
2025-04-21 13:54:24,724 [INFO]  Epoch time: 2254.16 sec
2025-04-21 13:54:25,516 [INFO]  Saved new best model at epoch 7 to /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18noaugmentation/trained_model_arcface.pth
2025-04-21 13:54:25,518 [INFO] Started epoch 8
2025-04-21 14:32:00,786 [INFO] [Epoch 8] Train Loss: 8.0259, Val Loss: 9.3136, LR: 0.000056
2025-04-21 14:32:00,788 [INFO]  Epoch time: 2255.27 sec
2025-04-21 14:32:01,675 [INFO]  Saved new best model at epoch 8 to /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18noaugmentation/trained_model_arcface.pth
2025-04-21 14:32:01,677 [INFO] Started epoch 9
2025-04-21 15:10:05,640 [INFO] [Epoch 9] Train Loss: 7.5831, Val Loss: 9.1989, LR: 0.000045
2025-04-21 15:10:05,642 [INFO]  Epoch time: 2283.96 sec
2025-04-21 15:10:06,318 [INFO]  Saved new best model at epoch 9 to /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18noaugmentation/trained_model_arcface.pth
2025-04-21 15:10:06,320 [INFO] Started epoch 10
2025-04-21 15:47:46,762 [INFO] [Epoch 10] Train Loss: 7.2457, Val Loss: 9.0545, LR: 0.000035
2025-04-21 15:47:46,764 [INFO]  Epoch time: 2260.44 sec
2025-04-21 15:47:47,446 [INFO]  Saved new best model at epoch 10 to /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18noaugmentation/trained_model_arcface.pth
2025-04-21 15:47:47,448 [INFO] Started epoch 11
2025-04-21 16:26:12,408 [INFO] [Epoch 11] Train Loss: 6.9824, Val Loss: 9.0010, LR: 0.000026
2025-04-21 16:26:12,410 [INFO]  Epoch time: 2304.96 sec
2025-04-21 16:26:13,124 [INFO]  Saved new best model at epoch 11 to /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18noaugmentation/trained_model_arcface.pth
2025-04-21 16:26:13,126 [INFO] Started epoch 12
2025-04-21 17:04:49,618 [INFO] [Epoch 12] Train Loss: 6.7792, Val Loss: 8.9707, LR: 0.000017
2025-04-21 17:04:49,620 [INFO]  Epoch time: 2316.49 sec
2025-04-21 17:04:50,332 [INFO]  Saved new best model at epoch 12 to /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18noaugmentation/trained_model_arcface.pth
2025-04-21 17:04:50,334 [INFO] Started epoch 13
2025-04-21 17:43:08,464 [INFO] [Epoch 13] Train Loss: 6.6538, Val Loss: 8.9443, LR: 0.000010
2025-04-21 17:43:08,466 [INFO]  Epoch time: 2298.13 sec
2025-04-21 17:43:09,151 [INFO]  Saved new best model at epoch 13 to /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18noaugmentation/trained_model_arcface.pth
2025-04-21 17:43:09,152 [INFO] Started epoch 14
2025-04-21 18:21:06,154 [INFO] [Epoch 14] Train Loss: 6.5593, Val Loss: 8.9003, LR: 0.000005
2025-04-21 18:21:06,156 [INFO]  Epoch time: 2277.00 sec
2025-04-21 18:21:06,832 [INFO]  Saved new best model at epoch 14 to /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18noaugmentation/trained_model_arcface.pth
2025-04-21 18:21:06,833 [INFO] Started epoch 15
2025-04-21 18:59:48,244 [INFO] [Epoch 15] Train Loss: 6.5306, Val Loss: 8.8974, LR: 0.000002
2025-04-21 18:59:48,245 [INFO]  Epoch time: 2321.41 sec
2025-04-21 18:59:48,934 [INFO]  Saved new best model at epoch 15 to /home/stud/aleks99/bhome/DAT550-Animal-CLEF/model_data/2025-04-21_resnet18noaugmentation/trained_model_arcface.pth
2025-04-21 18:59:48,936 [INFO] Training completed. Starting evaluation...
2025-04-21 20:02:39,870 [INFO] Evaluation completed successfully
