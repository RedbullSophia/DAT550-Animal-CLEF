/bin/bash: /opt/miniconda39/lib/libtinfo.so.6: no version information available (required by /bin/bash)
CUDA is a parallel computing platform for computing on GPUs, https://developer.nvidia.com/cuda-toolkit
prepending to __UENV: cuda-11.4.4
setting env CUDA_HOME=/usr/local/_cuda/cuda-11.4.4_ubuntu22
prepending to PATH: /usr/local/_cuda/cuda-11.4.4_ubuntu22/bin
prepending to LD_LIBRARY_PATH: /usr/local/_cuda/cuda-11.4.4_ubuntu22/lib64


A GPU-accelerated library of primitives for deep neural networks, https://developer.nvidia.com/cudnn
prepending to __UENV: cudnn-11.x-8.8.0
prepending to LD_LIBRARY_PATH: /usr/local/_cuda/cudnn-11.x-8.8.0/lib



Python 3.11.5
2025-04-01 00:39:24,210 [INFO] [Epoch 7] ArcFace Loss: 8.3936
2025-04-01 00:39:24,212 [INFO]  Epoch time: 330.03 sec
2025-04-01 00:39:24,273 [INFO]  Saved new best model at epoch 7
2025-04-01 00:39:24,274 [INFO] Started epoch 8
2025-04-01 00:39:40,274 [INFO] Using device: cuda
2025-04-01 00:39:40,346 [INFO] GPU: NVIDIA A100-PCIE-40GB
2025-04-01 00:39:40,349 [INFO] Loading dataset...
2025-04-01 00:39:43,645 [INFO] PyTorch version 2.6.0 available.
Loaded 111521 images across 9819 identities.
/home/stud/aleks99/.local/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
2025-04-01 00:39:52,762 [INFO] Loading pretrained weights from Hugging Face hub (timm/mobilenetv3_small_100.lamb_in1k)
2025-04-01 00:39:53,171 [INFO] [timm/mobilenetv3_small_100.lamb_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
/mnt/beegfs/home/aleks99/DAT550-Animal-CLEF/model/arg_run.py:119: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
2025-04-01 00:39:54,610 [INFO] Started epoch 1
2025-04-01 00:44:57,360 [INFO] [Epoch 8] ArcFace Loss: 5.7405
2025-04-01 00:44:57,362 [INFO]  Epoch time: 333.09 sec
2025-04-01 00:44:57,419 [INFO]  Saved new best model at epoch 8
2025-04-01 00:44:57,422 [INFO] Started epoch 9
/mnt/beegfs/home/aleks99/DAT550-Animal-CLEF/model/arg_run.py:47: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Traceback (most recent call last):
  File "/mnt/beegfs/home/aleks99/DAT550-Animal-CLEF/model/arg_run.py", line 121, in <module>
    train(model, train_loader, optimizer, loss_fn, scaler, DEVICE, save_path, args.num_epochs)
  File "/mnt/beegfs/home/aleks99/DAT550-Animal-CLEF/model/arg_run.py", line 48, in train
    embeddings = model(images)
                 ^^^^^^^^^^^^^
  File "/home/stud/aleks99/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/stud/aleks99/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/beegfs/home/aleks99/DAT550-Animal-CLEF/model/ReIDNet.py", line 23, in forward
    x = self.backbone(x)
        ^^^^^^^^^^^^^^^^
  File "/home/stud/aleks99/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/stud/aleks99/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/stud/aleks99/.local/lib/python3.11/site-packages/timm/models/mobilenetv3.py", line 271, in forward
    x = self.forward_features(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/stud/aleks99/.local/lib/python3.11/site-packages/timm/models/mobilenetv3.py", line 255, in forward_features
    x = self.blocks(x)
        ^^^^^^^^^^^^^^
  File "/home/stud/aleks99/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/stud/aleks99/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/stud/aleks99/.local/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/home/stud/aleks99/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/stud/aleks99/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/stud/aleks99/.local/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/home/stud/aleks99/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/stud/aleks99/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/stud/aleks99/.local/lib/python3.11/site-packages/timm/models/_efficientnet_blocks.py", line 291, in forward
    x = self.se(x)
        ^^^^^^^^^^
  File "/home/stud/aleks99/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/stud/aleks99/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/stud/aleks99/.local/lib/python3.11/site-packages/timm/models/_efficientnet_blocks.py", line 68, in forward
    return x * self.gate(x_se)
           ~~^~~~~~~~~~~~~~~~~
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 282.00 MiB. GPU 0 has a total capacity of 39.38 GiB of which 30.25 MiB is free. Process 1575323 has 5.81 GiB memory in use. Process 606538 has 16.53 GiB memory in use. Including non-PyTorch memory, this process has 16.98 GiB memory in use. Of the allocated memory 16.48 GiB is allocated by PyTorch, and 8.15 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-04-01 00:50:32,787 [INFO] [Epoch 9] ArcFace Loss: 3.9392
2025-04-01 00:50:32,789 [INFO]  Epoch time: 335.37 sec
2025-04-01 00:50:32,847 [INFO]  Saved new best model at epoch 9
2025-04-01 00:50:32,849 [INFO] Started epoch 10
2025-04-01 00:56:02,767 [INFO] [Epoch 10] ArcFace Loss: 2.7207
2025-04-01 00:56:02,768 [INFO]  Epoch time: 329.92 sec
2025-04-01 00:56:02,818 [INFO]  Saved new best model at epoch 10
